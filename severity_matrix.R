severity_matrix <- matrix(c(
  #stroke
  #c(1, 1, 0, 1, 0, 0, 0, 0, rep(0,24), 0.45),
  c(0, 0, 0, 1, 0, 0, 0, 0, rep(0,24), 0.55),
  c(0, 0, 0, 0, 1, 1, 1, 0, rep(0,24), 0.38),
  c(0, 0, 0, 0, 0, 0, 0, 1, rep(0,24), 0.62),
  #c(1, 0, 0, 0, -4.9, 0, 0, 0, rep(0,24), 0),
  #c(0, 1, 0, 0, 0, -2.2, 0, 0, rep(0,24), 0),
  c(0, 1, 1, 0, 0, 1, 1, 0, rep(0,24), 2*0.406),
  c(0, 0, 0, 1, 0, 0, 0, 1, rep(0,24), 2*0.437),
  c(1, 0, 0, 0, 0, 0, 0, 0, rep(0,24), 0.139),
  c(0, 1, 0, 0, 0, 0, 0, 0, rep(0,24), 0.142),
  c(0, 0, 1, 0, 0, 0, 0, 0, rep(0,24), 0.223),
  c(0, 0, 0, 1, 0, 0, 0, 0, rep(0,24), 0.495),
  c(0, 0, 0, 0, 1, 0, 0, 0, rep(0,24), 0.092),
  c(0, 0, 0, 0, 0, 1, 0, 0, rep(0,24), 0.115),
  c(0, 0, 0, 0, 0, 0, 1, 0, rep(0,24), 0.231),
  c(0, 0, 0, 0, 0, 0, 0, 1, rep(0,24), 0.562),
  c(1, 0, 0, 0, 1, 0, 0, 0, rep(0,24), 0.125),
  c(1, 0, 0 , 0, 0, 0, 0, 0, rep(0,24), 0.277),
  c(0, 0, 0, 0, 1, 0, 0, 0, rep(0,24), 0.199),
  c(1, 1, 1, 1, 0, 0, 0, 0, rep(0,24), 1),
  c(0, 0, 0, 0, 1, 1, 1, 1, rep(0,24), 1),
  #new stroke values below 10.9.2024
  c(0.55, 0.55, 0.55, -0.45, 0, 0, 0, 0, rep(0,24), 0),
  c(1, 0, 0, 0, 0, 0, 0, 0, rep(0,24), 0.364),
  c(0, 1, 0, 0, 0, 0, 0, 0, rep(0,24), 0.136),
  c(0, 0, 1, 0, 0, 0, 0, 0, rep(0,24), 0.182),
  c(0, 0, 0, 1, 0, 0, 0, 0, rep(0,24), 0.318),
  c(0, 0, 0, 0, 1, 0, 0, 0, rep(0,24), 0.312),
  c(0, 0, 0, 0, 0, 1, 0, 0, rep(0,24), 0.124),
  c(0, 0, 0, 0, 0, 0, 1, 0, rep(0,24), 0.250),
  c(0, 0, 0, 0, 0, 0, 0, 1, rep(0,24), 0.312),
  c(1, 1, 1, 0, 0, 0, 0, 0, rep(0,24), 0.572),
  c(0, 0, 0, 1, 0, 0, 0, 0, rep(0,24), 0.428),
  c(0, 0, 0, 0, 1, 1, 1, 0, rep(0,24), 0.494),
  c(0, 0, 0, 0, 0, 0, 0, 1, rep(0,24), 0.506),
  c(0, 0, 0, -1.25, 0, 0, 0, 1, rep(0,24), 0),
  #intracerebral
  c(rep(0,8), 1, 0, 0, 0, 1, 0, 0, 0,rep(0,16), 2*0.432),
  c(rep(0,8), 0, 0, 0, 0, 1, 0, 0, 0, rep(0,16), 0.486),
  c(rep(0,8), 0, 0, 0, 0, 0, 1, 0, 0, rep(0,16), 0.34),
  c(rep(0,8), 0, 0, 0, 0, 0, 0, 0, 1, rep(0,16), 0.24),
  c(rep(0,8), 1, 0, 0, 0, 0, 0, 0, 0, rep(0,16), 0.311),
  c(rep(0,8), 0, 0, 0, 0, 1, 0, 0, 0, rep(0,16), 0.456),
  c(rep(0,8), 1, 0, 0, 0, 0, 0, 0, 0, rep(0,16), 0.25),
  c(rep(0,8), 0, 1, 0, 0, 0, 0, 0, 0, rep(0,16), 0.27),
  c(rep(0,8), 0, 0, 0, 1, 0, 0, 0, 0, rep(0,16), 0.27),
  c(rep(0,8), 0, 0, 0, 0, 1, 0, 0, 0, rep(0,16), 0.37),
  c(rep(0,8), 0, 0, 0, 0, 0, 1, 0, 0, rep(0,16), 0.22),
  c(rep(0,8), 0, 0, 0, 0, 0, 0, 0, 1, rep(0,16), 0.23),
  c(rep(0,8), -1.62, 0, 0, 0, 1, 0, 0, 0, rep(0,16), 0),
  #c(rep(0,8), 1, 0, 0, 0, 0, 0, 0, 0, rep(0,16), 0.286),
  #c(rep(0,8), 0, 1, 0, 0, 0, 0, 0, 0, rep(0,16), 0.407),
  #c(rep(0,8), 0, 0, 1, 0, 0, 0, 0, 0, rep(0,16), 0.123),
  #c(rep(0,8), 0, 0, 0, 1, 0, 0, 0, 0, rep(0,16), 0.184),
  #c(rep(0,8), 0, 0, 0, 0, 1, 0, 0, 0, rep(0,16), 0.576),
  #c(rep(0,8), 0, 0, 0, 0, 0, 1, 0, 0, rep(0,16), 0.237),
  #c(rep(0,8), 0, 0, 0, 0, 0, 0, 1, 0, rep(0,16), 0.102),
  #c(rep(0,8), 0, 0, 0, 0, 0, 0, 0, 1, rep(0,16), 0.085),
  c(rep(0,8), 1, 0, 0, 0, 0, 0, 0, 0, rep(0,16), 0.225),
  c(rep(0,8), 0, 1, 0, 0, 0, 0, 0, 0, rep(0,16), 0.453),
  c(rep(0,8), 0, 0, 1, 0, 0, 0, 0, 0, rep(0,16), 0.212),
  c(rep(0,8), 0, 0, 0, 1, 0, 0, 0, 0, rep(0,16), 0.110),
  c(rep(0,8), 0, 0, 0, 0, 1, 0, 0, 0, rep(0,16), 0.442),
  c(rep(0,8), 0, 0, 0, 0, 0, 1, 0, 0, rep(0,16), 0.418),
  c(rep(0,8), 0, 0, 0, 0, 0, 0, 1, 0, rep(0,16), 0.07),
  c(rep(0,8), 0, 0, 0, 0, 0, 0, 0, 1, rep(0,16), 0.07),
  c(rep(0,8), 1, 0, 0, 0, 1, 0, 0, 0, rep(0,16), 2*0.13),
  c(rep(0,8), 1, 0, 0, 0, 1, 0, 0, 0, rep(0,16), 2*0.14),
  c(rep(0,8), 1, 0, 0, 0, 1, 0, 0, 0, rep(0,16), 2*0.19),
  c(rep(0,8), 0, 1, 0, 0, 0, 1, 0, 0, rep(0,16), 2*0.21),
  c(rep(0,8), 0, 1, 0, 0, 0, 1, 0, 0, rep(0,16), 2*0.16),
  c(rep(0,8), 0, 1, 0, 0, 0, 1, 0, 0, rep(0,16), 2*0.15),
  c(rep(0,8), 0, 1, 0, 0, 0, 1, 0, 0, rep(0,16), 2*0.11),
  c(rep(0,8), 0, 0, 1, 0, 0, 0, 1, 0, rep(0,16), 2*0.39),
  c(rep(0,8), 0, 0, 1, 0, 0, 0, 1, 0, rep(0,16), 2*0.20),
  c(rep(0,8), 0, 0, 0, 1, 0, 0, 0, 1, rep(0,16), 2*0.25),
  c(rep(0,8), 0, 0, 0, 1, 0, 0, 0, 1, rep(0,16), 2*0.32),
  c(rep(0,8), 0, 0, 0, 1, 0, 0, 0, 1, rep(0,16), 2*0.46),
  c(rep(0,8), 0, 0, 0, 1, 0, 0, 0, 1, rep(0,16), 2*0.53),
  c(rep(0,8), 1, 1, 1, 1, 0, 0, 0, 0, rep(0,16), 1),
  c(rep(0,8), 0, 0, 0, 0, 1, 1, 1, 1, rep(0,16), 1),
  #intracranial
  c(rep(0,16), 1, 0, 0, 0, 0, 0, 0, 0, rep(0,8), 0.21),
  c(rep(0,16), 0, 0, 0, 0, 1, 0, 0, 0, rep(0,8), 0.32),
  c(rep(0,16), 1, 0, 0, 0, 0, 0, 0, 0, rep(0,8), 0.30),
  c(rep(0,16), 0, 0, 0, 0, 1, 0, 0, 0, rep(0,8), 0.32),
  c(rep(0,16), -1.5, 0, 0, 0, 1, 0, 0, 0, rep(0,8), 0),
  c(rep(0,16), 1, 0, 0, 0, 1, 0, 0, 0, rep(0,8), 2*0.25),
  c(rep(0,16), 1, 1, 0, 0, 1, 1, 0, 0, rep(0,8), 2*0.50),
  c(rep(0,16), 1, 1, 0, 0, 0, 0, 0, 0, rep(0,8), 0.190),
  c(rep(0,16), 0, 0, 0, 0, 1, 1, 0, 0, rep(0,8), 0.268),
  #c(rep(0,16), -2.3, -2.3, 0, 0, 1, 1, 0, 0, rep(0,8), 0),
  #c(rep(0,16), 0, 0, 1, 1, 0, 0, 0, 0, rep(0,8), 0.405),
  #c(rep(0,16), 0, 0, 0, 0, 0, 0, 1, 1, rep(0,8), 0.23),
  #c(rep(0,16), 0, 0, 1, 1, 0, 0, 1, 1, rep(0,8), 2*0.53),
  c(rep(0,16), 0, 0, 1, -1, 0, 0, 0, 0, rep(0,8), 0),
  c(rep(0,16), 0, 0, 0, 0, 0, 0, 1, -1, rep(0,8), 0),
  c(rep(0,16), 1, 0, 0, 0, 1, 0, 0, 0, rep(0,8), 2*0.05),
  c(rep(0,16), 1, 0, 0, 0, 1, 0, 0, 0, rep(0,8), 2*0.131),
  c(rep(0,16), 1, 0, 0, 0, 1, 0, 0, 0, rep(0,8), 2*0.17),
  #c(rep(0,16), -1.9, 0, 0, 0, 1, 0, 0, 0, rep(0,8), 0),
  c(rep(0,16), 0, -75.3/24.7, 1, 1, 0, -75.3/24.7, 1, 1, rep(0,8), 0),
  c(rep(0,16), 1, 1, 1, 1, 0, 0, 0, 0, rep(0,8), 1),
  c(rep(0,16), 0, 0, 0, 0, 1, 1, 1, 1, rep(0,8), 1),
  #extracranial
  c(rep(0,24), -2.15, 0, 0, 0, 1, 0, 0, 0, 0),
  c(rep(0,24), 0, 0, 0, 0, 1, 0, 0, 0, 0.051),
  c(rep(0,24), 0, 0, 0, 0, 0, 1, 0, 0, 0.01),
  c(rep(0,24), 0, 0, 0, 0, 0, 0, 1, 0, 0.06),
  c(rep(0,24), 0, 0, 0, 0, 0, 0, 0, 1, 0.91),
  c(rep(0,24), 0, 0, 0, 0, 1, 0, 0, 0, 0.09),
  c(rep(0,24), 1, 0, 0, 0, 1, 0, 0, 0, 2*0.04),
  c(rep(0,24), 0, 1, 0, 0, 0, -1, 0, 0, 0), 
  c(rep(0,24), 0, 0, 1, 0, 0, 0, -1, 0, 0),
  c(rep(0,24), 0, 0, 0, -1, 0, 0, 0, 1, 0),
  c(rep(0,24), 1, 1, 1, 1, 0, 0, 0, 0, 1),
  c(rep(0,24), 0, 0, 0, 0, 1, 1, 1, 1, 1),
  c(rep(0,24), 1, 0, 0, 0, 1, 0, 0, 0, 0.08),
  #c(rep(0,24), 0, 0, 0, 1, 0, 0, 0, 1, 0.71*2),
  c(rep(0,24), 0, 0, 0, 0, 1, 0, 0, 0, 0.022),
  c(rep(0,24), 0, 0, 0, 0, 1, 0, 0, 0, 0.042),
  c(rep(0,24), 0, 0, 0, 0, 1, 0, 0, 0, 0.043),
  c(rep(0,28), 1, 0, 0, 0, 0.022),
  c(rep(0,28), 1, 0, 0, 0, 0.048),
  c(rep(0,28), 1, 0, 0, 0, 0.154),
  #all
  c(rep(0,12), 1, 0, 0, 0, rep(0,4), 1, 0, 0, 0, rep(0,4), 1, 0, 0, 0, 3*0.094)
  #-----why these are left out? ---------------
  #c(rep(0,12), 1, 0, 0, 0, rep(0,4), 1, 0, 0, 0, rep(0,4), 1, 0, 0, 0, 3*0.077),
  #c(rep(0,12), 1, 0, 0, 0, rep(0,4), 1, 0, 0, 0, rep(0,4), 1, 0, 0, 0, 3*0.083),
  #c(rep(0,12), 1, 0, 0, 0, rep(0,4), 1, 0, 0, 0, rep(0,4), 1, 0, 0, 0, 3*0.078),
  #c(rep(0,12), 1, 0, 0, 0, rep(0,4), 1, 0, 0, 0, rep(0,8), 2*0.399)
  #c(rep(0,12), 1, 0, 0, 0, rep(0,4), 1, 0, 0, 0, rep(0,8), 2*0.393),
  #c(rep(0,12), 1, 0, 0, 0, rep(0,4), 1, 0, 0, 0, rep(0,8), 2*0.293),
  #c(rep(0,12), 1, 0, 0, 0, rep(0,4), 1, 0, 0, 0, rep(0,8), 2*0.39)
),
ncol = 33,
byrow = TRUE
)
colnames(severity_matrix) <- c(paste0("StrokeNoNOAC",c("Death", "Severe", "Moderate", "Mild")),
                               paste0("StrokeYesNOAC", c("Death", "Severe", "Moderate", "Mild")),
                               paste0("IchNoNOAC",c("Death", "Severe", "Moderate", "Mild")),
                               paste0("IchYesNOAC", c("Death", "Severe", "Moderate", "Mild")),
                               paste0("SubNoNOAC",c("Death", "Severe", "Moderate", "Mild")),
                               paste0("subYesNOAC", c("Death", "Severe", "Moderate", "Mild")),
                               paste0("OtherNoNOAC",c("Death", "Severe", "Moderate", "Mild")),
                               paste0("OtherYesNOAC", c("Death", "Severe", "Moderate", "Mild")),
                               "Val")
severity_matrix[,33] <- severity_matrix[,33]
severity_model <- lm(severity_matrix[,33] ~ severity_matrix[,-33] -1)
severity_No_NOAC_coefficients <- c(coefficients(severity_model)[1:4] / sum(coefficients(severity_model)[1:4]),
                                   coefficients(severity_model)[9:12] / sum(coefficients(severity_model)[9:12]),
                                   coefficients(severity_model)[17:20] / sum(coefficients(severity_model)[17:20]),
                                   coefficients(severity_model)[25:28] / sum(coefficients(severity_model)[25:28]))#normalized
severity_Yes_NOAC_coefficients <- c(coefficients(severity_model)[5:8] / sum(coefficients(severity_model)[5:8]),
                                    coefficients(severity_model)[13:16] / sum(coefficients(severity_model)[13:16]),
                                    coefficients(severity_model)[21:24] / sum(coefficients(severity_model)[21:24]),
                                    coefficients(severity_model)[29:32] / sum(coefficients(severity_model)[29:32]))#normalized
data <- data.frame(
  NoNOAC = as.numeric(severity_No_NOAC_coefficients), 
  YesNOAC = as.numeric(severity_Yes_NOAC_coefficients), 
  group_names = c(rep("Stroke", 4), rep("Hemorrhagic stroke", 4), rep("Other intracranial bleeding", 4), rep("Extracranial bleeding", 4)),
  row_names = c(rep(c("Death", "Severe", "Moderate", "Mild"),2), rep(c("Death", "Severe", "Mild", "Nothing"),2)))
